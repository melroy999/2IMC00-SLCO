// VerCors verification instructions for SLCO state machine {{ model.name }}.
class SlcoStateMachine{{ model.name }}InSlcoClass{{ model.parent.name }} {
    // The class the state machine is a part of.
    private final SlcoClass{{ model.parent.name }} c;

    // A list of lock ids and target locks that can be reused
    private final int[] lock_ids;
    private final int[] target_locks;

    {% if model.variables | length > 0 %}
    // State machine local variables.
    {% for v in model.variables %}
    {% if v.is_array %}
    final {{ v | render_type }} {{ v.name }}; // length {{ v.type.size }}
    {% else %}
    {{ v | render_type }} {{ v.name }};
    {% endif %}
    {% endfor %}

    {% endif %}
    /*@
    // Ensure full access to the class members.
    ensures Perm(this.c, 1);
    ensures Perm(this.lock_ids, 1);
    ensures Perm(this.target_locks, 1);

    // Require that the input class is a valid object.
    requires c != null;

    // Ensure that the appropriate starter values are assigned.
    ensures this.c == c;
    ensures this.lock_ids != null && this.lock_ids.length == {{ model.lock_ids_list_size }};
    ensures this.target_locks != null && this.target_locks.length == {{ model.target_locks_list_size }};
    @*/
    SlcoStateMachine{{ model.name }}InSlcoClass{{ model.parent.name }}(SlcoClass{{ model.parent.name }} c) {
        this.c = c;
        this.lock_ids = new int[{{ model.lock_ids_list_size }}];
        this.target_locks = new int[{{ model.target_locks_list_size }}];
        {% if model.variables | length > 0 %}

        // Variable instantiations.
        {% for v in model.variables %}
        this.{{ v.name }} = {{ v | render_variable_default_value }};
        {% endfor %}
        {% endif %}
    }

    {% for t in model.transitions %}
    {{ t | render_vercors_transition | indent(4, False) | trim }}

    {% endfor %}
}